#I received many regulatory marks processed by Manu Singh in hg19 (processing pipeline on his github)
#Liftover to hg38:

/home/tc643/liftOver ../LTR7_active_FOXA1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_FOXA1_hESC.bed LTR7_active_FOXA1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_FOXA2_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_FOXA2_hESC.bed LTR7_active_FOXA2_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_H3K27Ac_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_H3K27Ac_hESCs.bed LTR7_active_H3K27Ac_hESCs.bed.unlifted
/home/tc643/liftOver ../LTR7_active_KLF4_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_KLF4_hESC.bed LTR7_active_KLF4_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_MED1_OCT4_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_MED1_OCT4_hESCs.bed LTR7_active_MED1_OCT4_hESCs.bed.unlifted
/home/tc643/liftOver ../LTR7_active_MED1_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_MED1_hESCs.bed LTR7_active_MED1_hESCs.bed.unlifted
/home/tc643/liftOver ../LTR7_active_NANOG_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_NANOG_hESC.bed LTR7_active_NANOG_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_OCT4_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_OCT4_hESCs.bed LTR7_active_OCT4_hESCs.bed.unlifted

/home/tc643/liftOver ../LTR7_active_SMAD1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_SMAD1_hESC.bed LTR7_active_SMAD1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_SOX2_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_SOX2_hESC.bed LTR7_active_SOX2_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_active_TCF4_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_active_TCF4_hESC.bed LTR7_active_TCF4_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_hESC_active_FOXP1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_hESC_active_FOXP1_hESC.bed LTR7_hESC_active_FOXP1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_hESC_inactive_FOXP1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_hESC_inactive_FOXP1_hESC.bed LTR7_hESC_inactive_FOXP1_hESC.bed.unlifted

/home/tc643/liftOver ../LTR7_inactive_FOXA1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_FOXA1_hESC.bed LTR7_inactive_FOXA1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_FOXA2_hESC.bedd /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_FOXA2_hESC.bed LTR7_inactive_FOXA2_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_hESC_inactive_FOXP1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_hESC_inactive_FOXP1_hESC.bed LTR7_hESC_inactive_FOXP1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_H3K27Ac_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_H3K27Ac_hESCs.bed LTR7_inactive_H3K27Ac_hESCs.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_KLF4_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_KLF4_hESC.bed LTR7_inactive_KLF4_hESC.bed.unlifted

/home/tc643/liftOver ../LTR7_inactive_MED1_OCT4_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_MED1_OCT4_hESC.bed LTR7_inactive_MED1_OCT4_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_MED1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_MED1_hESC.bed LTR7_inactive_MED1_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_NANOG_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_NANOG_hESC.bed LTR7_inactive_NANOG_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_OCT4_hESCs.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_OCT4_hESCs.bed LTR7_inactive_OCT4_hESCs.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_SMAD1_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_SMAD1_hESC.bed LTR7_inactive_SMAD1_hESC.bed.unlifted

/home/tc643/liftOver ../LTR7_inactive_SOX2_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_SOX2_hESC.bed LTR7_inactive_SOX2_hESC.bed.unlifted
/home/tc643/liftOver ../LTR7_inactive_TCF4_hESC.bed /workdir/tc643/liftOver_files/hg19ToHg38.over.chain LTR7_inactive_TCF4_hESC.bed LTR7_inactive_TCF4_hESC.bed.unlifted

#all coors lifted over
rm *unlifted*

#marks were intersected with the list of 5' and solo LTR7 that are part of groups in figure 1b (347_solo_5prime_LTRs_corrected_coords_uniq.bed)
#positives were added onto the name of each insertion in the bed file: eg 
#	intersectBed -u -a ../../347_solo_5prime_LTRs_corrected_coords_uniq.bed -b LTR7_ALL_FOXP1_hESC.bed > HERVH_LTR7_FOXP1.bed 
#	awk '{print $1 "\t" $2 "\t" $3 "\t" $4",FOXP1" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_FOXP1.bed > 347_HERVH_LTR7_FOXP1_info.bed 

#keeping all info in the name was handy for analyzing trends in figtree, which you can also do from the .nwk
	# eg search for "foxp1" and color those insertions
#however, for the final figure, this regulatory info was converted into a matrix (bigtreematrix_heat.csv) as required by R



#flag LTR7 with any overlap between LTR and given marks:

intersectBed -u -a ../../347_solo_5prime_LTRs_corrected_coords_uniq.bed -b LTR7_ALL_FOXP1_hESC.bed > HERVH_LTR7_FOXP1.bed 
intersectBed -v -a ../../347_solo_5prime_LTRs_corrected_coords_uniq.bed -b LTR7_ALL_FOXP1_hESC.bed > HERVH_LTR7_antiFOXP1.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",FOXP1" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_FOXP1.bed > 347_HERVH_LTR7_FOXP1_info.bed 
cat 347_HERVH_LTR7_FOXP1_info.bed HERVH_LTR7_antiFOXP1.bed > 347_HERVH_LTR7_FOXP1_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_done.bed -b LTR7_ALL_KLF4_hESC.bed > HERVH_LTR7_KLF4.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_done.bed -b LTR7_ALL_KLF4_hESC.bed > HERVH_LTR7_antiKLF4.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",KLF4" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_KLF4.bed  > 347_HERVH_LTR7_FOXP1_KLF4_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_info.bed HERVH_LTR7_antiKLF4.bed > 347_HERVH_LTR7_FOXP1_KLF4_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_done.bed -b LTR7_ALL_MED1_hESC.bed > HERVH_LTR7_MED1.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_done.bed -b LTR7_ALL_MED1_hESC.bed > HERVH_LTR7_antiMED1.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",MED1" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_MED1.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_info.bed HERVH_LTR7_antiMED1.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_done.bed -b LTR7_ALL_NANOG_hESC.bed > HERVH_LTR7_NANOG.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_done.bed -b LTR7_ALL_NANOG_hESC.bed > HERVH_LTR7_antiNANOG.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",NANOG" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_NANOG.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_info.bed HERVH_LTR7_antiNANOG.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1__NANOG_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1__NANOG_done.bed -b LTR7_ALL_OCT4_hESC.bed > HERVH_LTR7_OCT4.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1__NANOG_done.bed -b LTR7_ALL_OCT4_hESC.bed > HERVH_LTR7_antiOCT4.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",OCT4" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_OCT4.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_info.bed HERVH_LTR7_antiOCT4.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_done.bed -b LTR7_ALL_SMAD11_hESC.bed > HERVH_LTR7_SMAD11.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_done.bed -b LTR7_ALL_SMAD11_hESC.bed > HERVH_LTR7_antiSMAD11.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",SMAD11" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_SMAD11.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_info.bed HERVH_LTR7_antiSMAD11.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_done.bed -b LTR7_ALL_SOX2_hESC.bed > HERVH_LTR7_SOX2.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_done.bed -b LTR7_ALL_SOX2_hESC.bed > HERVH_LTR7_antiSOX2.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",SOX2" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_SOX2.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_info.bed HERVH_LTR7_antiSOX2.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_done.bed -b LTR7_ALL_TCF4_hESC.bed > HERVH_LTR7_TCF4.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_done.bed -b LTR7_ALL_TCF4_hESC.bed > HERVH_LTR7_antiTCF4.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",TCF4" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_TCF4.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_info.bed HERVH_LTR7_antiTCF4.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_done.bed -b LTR7_ALL_FOXA1_hESC.bed > HERVH_LTR7_FOXA1.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_done.bed -b LTR7_ALL_FOXA1_hESC.bed > HERVH_LTR7_antiFOXA1.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",FOXA1" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_FOXA1.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_info.bed HERVH_LTR7_antiFOXA1.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_done.bed -b /workdir/tc643/LTR_differential_activity/7up/LTR7up.bed > HERVH_LTR7_7up.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_done.bed -b /workdir/tc643/LTR_differential_activity/7up/LTR7up.bed > HERVH_LTR7_anti7up.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",7up" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_7up.bed  > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_7up_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_7up_info.bed HERVH_LTR7_anti7up.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_7up_done.bed

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_7up_done.bed -b wang_highly_active_hg38.bed > HERVH_LTR7_wanghigh.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_7up_done.bed -b wang_highly_active_hg38.bed > HERVH_LTR7_antiwanghigh.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",wanghigh" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_wanghigh.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wanghigh_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wanghigh_info.bed HERVH_LTR7_antiwanghigh.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wanghigh_done.bed 

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wanghigh_done.bed -b wang_mod_active_hg38.bed > HERVH_LTR7_wangmod.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wanghigh_done.bed -b wang_mod_active_hg38.bed > HERVH_LTR7_antiwangmod.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",wangmod" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_wangmod.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wangmod_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wangmod_info.bed HERVH_LTR7_antiwangmod.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wangmod_done.bed 

intersectBed -u -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wangmod_done.bed -b wang_chimeric_transcripts_hg38.bed > HERVH_LTR7_chimeric.bed 
intersectBed -v -a 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_wangmod_done.bed -b wang_chimeric_transcripts_hg38.bed > HERVH_LTR7_antichimeric.bed 
awk '{print $1 "\t" $2 "\t" $3 "\t" $4",chimeric" "\t" $5 "\t" $6 "\t" $7}' HERVH_LTR7_chimeric.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_chimeric_info.bed 
cat 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_chimeric_info.bed HERVH_LTR7_antichimeric.bed > 347_HERVH_LTR7_FOXP1_KLF4_MED1_NANOG_OCT4_SMAD11_SOX2_TCF4_FOXA1_7up_chimeric_done.bed 

